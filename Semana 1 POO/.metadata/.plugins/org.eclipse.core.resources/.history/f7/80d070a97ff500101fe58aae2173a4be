package com.mx.Estudiante;

import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

public class Principal{

	public static void main(String[] args) {

		Estudiante e1 = new Estudiante("Lily", "Gonzalez", 26, "Sistemas", 11);
		Estudiante e2 = new Estudiante("Sebastian", "Ramirez", 27, "Quimica", 6);
		Estudiante e3 = new Estudiante("Raul", "Perez", 30, "Software", 3);
		Estudiante e4 = new Estudiante("Angel", "Corona", 29, "Administracion", 10);
		Estudiante e5 = new Estudiante("Javier", "Diaz", 35, "Mecatronica", 4);
		Estudiante e6 = new Estudiante("Mari", "Sanchez", 40, "Mecania", 8);
		Estudiante e7 = new Estudiante("Gabriela", "Flores", 20, "Biotecnologia", 7);

		Estudiante auAux = null;

		List<Estudiante> lista = new ArrayList<Estudiante>();
		lista.add(e1);
		lista.add(e2);
		lista.add(e3);
		lista.add(e4);
		lista.add(e5);
		lista.add(e6);
		lista.add(e7);

		Scanner scan = null;
		int menuPrincipal = 0, menuEditar = 0;

		String nombre, apellido, carrera;
		int edad, semestre;

		do {
			System.out.println("\n-----MENU REPASO------");
			System.out.println("1.- AGREGAR");
			System.out.println("2.- MOSTRAR");
			System.out.println("3.- BUSCAR POR ATRIBUTO");
			System.out.println("4.- EDITAR");
			System.out.println("5.- ELIMINAR POR ATRIBUTO");
			System.out.println("6.- CONTAR");
			System.out.println("7.- ELIMINAR TODO");
			System.out.println("8.- SALIR");
			System.out.println("ELIGE UNA OPCION");

			scan = new Scanner(System.in);
			menuPrincipal = scan.nextInt();

			switch (menuPrincipal) {

			case 1:
				System.out.println("1.- AGREGAR ESTUDIANTE");

				System.out.println("Escribe el nombre: ");
				scan = new Scanner(System.in);
				nombre = scan.nextLine();

				System.out.println("Escribe el apellido: ");
				scan = new Scanner(System.in);
				apellido = scan.nextLine();

				System.out.println("Escribe la edad: ");
				scan = new Scanner(System.in);
				edad = scan.nextInt();

				System.out.println("Escribe la carrera: ");
				scan = new Scanner(System.in);
				carrera = scan.nextLine();

				System.out.println("Escribe el semestre: ");
				scan = new Scanner(System.in);
				semestre = scan.nextInt();

				auAux = new Estudiante(nombre, apellido, edad, carrera, semestre);
				lista.add(auAux);

				System.out.println("Registro guardado con exito.");
				break;

			case 2:
				System.out.println("2.- MOSTRAR LISTA");
				if (lista.isEmpty()) {
					System.out.println("No existen estudiantes en la lista.");
				} else {
					for (int i = 0; i < lista.size(); i++) {
						System.out.println("Indice " + i + " -> " + lista.get(i));
					}
				}
				break;

			case 3:
				System.out.println("3.- BUSCAR POR ATRIBUTO");
				System.out.println("Buscar por:");
				System.out.println("1) Nombre");
				System.out.println("2) Apellido");
				System.out.println("3) Edad");
				System.out.println("4) Carrera");
				System.out.println("5) Semestre");
				System.out.println("Elige una opcion:");

				scan = new Scanner(System.in);
				int opBuscar = scan.nextInt();

				int encontrados = 0;

				switch (opBuscar) {
				case 1:
					System.out.println("Escribe el nombre a buscar:");
					scan = new Scanner(System.in);
					nombre = scan.nextLine();

					for (Estudiante e : lista) {
						if (e.getNombre().equalsIgnoreCase(nombre)) {
							System.out.println("Encontrado: " + e);
							encontrados++;
						}
					}
					break;

				case 2:
					System.out.println("Escribe el apellido a buscar:");
					scan = new Scanner(System.in);
					apellido = scan.nextLine();

					for (Estudiante e : lista) {
						if (e.getApellido().equalsIgnoreCase(apellido)) {
							System.out.println("Encontrado: " + e);
							encontrados++;
						}
					}
					break;

				case 3:
					System.out.println("Escribe la edad a buscar:");
					scan = new Scanner(System.in);
					edad = scan.nextInt();

					for (Estudiante e : lista) {
						if (e.getEdad() == edad) {
							System.out.println("Encontrado: " + e);
							encontrados++;
						}
					}
					break;

				case 4:
					System.out.println("Escribe la carrera a buscar:");
					scan = new Scanner(System.in);
					carrera = scan.nextLine();

					for (Estudiante e : lista) {
						if (e.getCarrera().equalsIgnoreCase(carrera)) {
							System.out.println("Encontrado: " + e);
							encontrados++;
						}
					}
					break;

				case 5:
					System.out.println("Escribe el semestre a buscar:");
					scan = new Scanner(System.in);
					semestre = scan.nextInt();

					for (Estudiante e : lista) {
						if (e.getSemestre() == semestre) {
							System.out.println("Encontrado: " + e);
							encontrados++;
						}
					}
					break;

				default:
					System.out.println("Opcion invalida en buscar.");
					break;
				}

				if (opBuscar >= 1 && opBuscar <= 5) {
					if (encontrados == 0) {
						System.out.println("No se encontro ningun estudiante con ese dato.");
					} else {
						System.out.println("Total encontrados: " + encontrados);
					}
				}
				break;

			case 4:
				System.out.println("4.- EDITAR");

				if (lista.isEmpty()) {
					System.out.println("No hay estudiantes para editar.");
					break;
				}

				System.out.println("Indica el indice a editar:");
				scan = new Scanner(System.in);
				int indiceEditar = scan.nextInt();

				if (indiceEditar < 0 || indiceEditar >= lista.size()) {
					System.out.println("Indice fuera de rango.");
					break;
				}

				auAux = lista.get(indiceEditar);

				do {
					System.out.println("\n---SUBMENU EDITAR---");
					System.out.println("1. Editar nombre");
					System.out.println("2. Editar apellido");
					System.out.println("3. Editar edad");
					System.out.println("4. Editar carrera");
					System.out.println("5. Editar semestre");
					System.out.println("6. Regresar al menu principal");
					System.out.println("Elige una opcion:");

					scan = new Scanner(System.in);
					menuEditar = scan.nextInt();

					switch (menuEditar) {
					case 1:
						System.out.println("Escribe el nuevo nombre:");
						scan = new Scanner(System.in);
						nombre = scan.nextLine();
						auAux.setNombre(nombre);
						System.out.println("Nombre editado.");
						break;

					case 2:
						System.out.println("Escribe el nuevo apellido:");
						scan = new Scanner(System.in);
						apellido = scan.nextLine();
						auAux.setApellido(apellido);
						System.out.println("Apellido editado.");
						break;

					case 3:
						System.out.println("Escribe la nueva edad:");
						scan = new Scanner(System.in);
						edad = scan.nextInt();
						auAux.setEdad(edad);
						System.out.println("Edad editada.");
						break;

					case 4:
						System.out.println("Escribe la nueva carrera:");
						scan = new Scanner(System.in);
						carrera = scan.nextLine();
						auAux.setCarrera(carrera);
						System.out.println("Carrera editada.");
						break;

					case 5:
						System.out.println("Escribe el nuevo semestre:");
						scan = new Scanner(System.in);
						semestre = scan.nextInt();
						auAux.setSemestre(semestre);
						System.out.println("Semestre editado.");
						break;

					case 6:
						System.out.println("Regresando al menu principal...");
						break;

					default:
						System.out.println("Opcion invalida en editar.");
						break;
					}

				} while (menuEditar != 6);

				break;

			case 5:
				System.out.println("5.- ELIMINAR POR ATRIBUTO");
				System.out.println("Eliminar por:");
				System.out.println("1) Nombre");
				System.out.println("2) Apellido");
				System.out.println("3) Edad");
				System.out.println("4) Carrera");
				System.out.println("5) Semestre");
				System.out.println("Elige una opcion:");

				scan = new Scanner(System.in);
				int opEliminar = scan.nextInt();

				int eliminados = 0;

				switch (opEliminar) {
				case 1:
					System.out.println("Escribe el nombre a eliminar:");
					scan = new Scanner(System.in);
					nombre = scan.nextLine();

					for (int i = 0; i < lista.size(); i++) {
						if (lista.get(i).getNombre().equalsIgnoreCase(nombre)) {
							lista.remove(i);
							i--;
							eliminados++;
						}
					}
					break;

				case 2:
					System.out.println("Escribe el apellido a eliminar:");
					scan = new Scanner(System.in);
					apellido = scan.nextLine();

					for (int i = 0; i < lista.size(); i++) {
						if (lista.get(i).getApellido().equalsIgnoreCase(apellido)) {
							lista.remove(i);
							i--;
							eliminados++;
						}
					}
					break;

				case 3:
					System.out.println("Escribe la edad a eliminar:");
					scan = new Scanner(System.in);
					edad = scan.nextInt();

					for (int i = 0; i < lista.size(); i++) {
						if (lista.get(i).getEdad() == edad) {
							lista.remove(i);
							i--;
							eliminados++;
						}
					}
					break;

				case 4:
					System.out.println("Escribe la carrera a eliminar:");
					scan = new Scanner(System.in);
					carrera = scan.nextLine();

					for (int i = 0; i < lista.size(); i++) {
						if (lista.get(i).getCarrera().equalsIgnoreCase(carrera)) {
							lista.remove(i);
							i--;
							eliminados++;
						}
					}
					break;

				case 5:
					System.out.println("Escribe el semestre a eliminar:");
					scan = new Scanner(System.in);
					semestre = scan.nextInt();

					for (int i = 0; i < lista.size(); i++) {
						if (lista.get(i).getSemestre() == semestre) {
							lista.remove(i);
							i--;
							eliminados++;
						}
					}
					break;

				default:
					System.out.println("Opcion invalida en eliminar.");
					break;
				}

				if (opEliminar >= 1 && opEliminar <= 5) {
					if (eliminados == 0) {
						System.out.println("No se elimino nada (no hubo coincidencias).");
					} else {
						System.out.println("Total eliminados: " + eliminados);
						System.out.println("Lista actualizada: " + lista);
					}
				}
				break;

			case 6:
				System.out.println("6.- CONTAR");
				System.out.println("Existen " + lista.size() + " estudiantes registrados.");
				break;

			case 7:
				System.out.println("7.- ELIMINAR TODO");
				lista.clear();
				System.out.println("Lista eliminada. Ahora esta vacia.");
				break;

			case 8:
				System.out.println("Saliendo del sistema. Vuelva pronto.");
				break;

			default:
				System.out.println("Opcion fuera de rango, intenta un numero del 1 al 8.");
				break;
			}

		} while (menuPrincipal != 8);

	}
}
